<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check - Settings</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="options.css">
</head>
<body>
    <div class="options-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <img src="../images/icon48.png" alt="Check Logo" class="sidebar-logo" id="sidebarLogo">
                            <div class="sidebar-title">
                <h2 id="sidebarTitle">Microsoft 365 Phishing Protection</h2>
                <span class="sidebar-version" id="sidebarVersion">v1.0.0</span>
            </div>
            </div>
            
            <ul class="sidebar-menu">
                <li><a href="#general" class="menu-item active" data-section="general">
                    <span class="menu-icon material-icons">settings</span>
                    <span class="menu-text">General</span>
                </a></li>
                <li><a href="#detection" class="menu-item" data-section="detection">
                    <span class="menu-icon material-icons">search</span>
                    <span class="menu-text">Detection Rules</span>
                </a></li>
                <li><a href="#logs" class="menu-item" data-section="logs">
                    <span class="menu-icon material-icons">assignment</span>
                    <span class="menu-text">Activity Logs</span>
                </a></li>
                <li><a href="#branding" class="menu-item" data-section="branding">
                    <span class="menu-icon material-icons">palette</span>
                    <span class="menu-text">Branding</span>
                </a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="content-header">
                <div class="header-title-section">
                    <h1 id="pageTitle">General Settings</h1>
                    <div class="policy-badge" id="policyBadge" style="display: none;">
                        <span class="material-icons">business</span>
                        <span class="badge-text">Managed by Policy</span>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" id="exportConfig">Export Config</button>
                    <button class="btn btn-secondary" id="importConfig">Import Config</button>
                    <button class="btn btn-primary" id="saveSettings">Save Settings</button>
                </div>
            </header>

            <!-- General Section -->
            <section id="general-section" class="settings-section active">
                <div class="section-header">
                    <h2>General Settings</h2>
                    <p>Configure basic phishing protection behavior and detection features</p>
                </div>

                <div class="settings-grid">
                    <div class="setting-group">
                        <h3>Extension Settings</h3>
                        <div class="setting-item">
                            <label class="setting-label">
                                <input type="checkbox" id="enablePageBlocking" class="setting-checkbox">
                                <span class="checkbox-custom"></span>
                                Enable Page Blocking
                            </label>
                            <p class="setting-description">Block access to detected phishing pages</p>
                        </div>
                        
                        <div class="setting-item">
                            <label class="setting-label">
                                <input type="checkbox" id="enablePhishingWarnings" class="setting-checkbox">
                                <span class="checkbox-custom"></span>
                                Warn on (potentially) fake logon pages
                            </label>
                            <p class="setting-description">Show warnings for suspicious Microsoft 365 login pages</p>
                        </div>
                        
                        <div class="setting-item">
                            <label class="setting-label">
                                <input type="checkbox" id="enableCippReporting" class="setting-checkbox">
                                <span class="checkbox-custom"></span>
                                Enable CIPP Reporting
                            </label>
                            <p class="setting-description">Send detection events to CIPP server for monitoring</p>
                        </div>
                        
                        <div class="setting-item">
                            <label class="setting-label">
                                CIPP Server URL
                                <input type="url" id="cippServerUrl" class="setting-input" placeholder="https://your-cipp-server.com">
                            </label>
                            <p class="setting-description">URL of your CIPP server for reporting Microsoft 365 logon detections</p>
                        </div>
                    </div>

                    <div class="setting-group">
                        <h3>User Interface</h3>
                        <div class="setting-item">
                            <label class="setting-label">
                                <input type="checkbox" id="showNotifications" class="setting-checkbox">
                                <span class="checkbox-custom"></span>
                                Show Notifications
                            </label>
                            <p class="setting-description">Display security notifications and warnings</p>
                        </div>
                        
                        <div class="setting-item">
                            <label class="setting-label">
                                <input type="checkbox" id="enableValidPageBadge" class="setting-checkbox">
                                <span class="checkbox-custom"></span>
                                Show Valid Page Badge
                            </label>
                            <p class="setting-description">Display a verification badge on legitimate Microsoft 365 login pages</p>
                        </div>
                        
                        <div class="setting-item">
                            <label class="setting-label">
                                Notification Duration
                                <input type="range" id="notificationDuration" class="setting-range" min="1000" max="10000" step="1000">
                            </label>
                            <span class="setting-value" id="notificationDurationValue">5s</span>
                            <p class="setting-description">How long notifications stay visible</p>
                        </div>
                    </div>
                </div>
            </section>


            <!-- Detection Section -->
            <section id="detection-section" class="settings-section">
                <div class="section-header">
                    <h2>Phishing Detection Rules</h2>
                    <p>Manage Microsoft 365 phishing detection patterns and custom rules</p>
                </div>

                <div class="settings-grid">
                    <div class="setting-group">
                        <h3>Detection Configuration</h3>
                        <div class="setting-item">
                            <label class="setting-label">
                                <input type="checkbox" id="enableCustomRules" class="setting-checkbox">
                                <span class="checkbox-custom"></span>
                                Enable Custom Rules
                            </label>
                            <p class="setting-description">Allow custom detection rules to be loaded</p>
                        </div>
                        
                        <div class="setting-item">
                            <label class="setting-label">
                                Custom Rules URL
                                <input type="url" id="customRulesUrl" class="setting-input" placeholder="https://example.com/rules.json">
                            </label>
                            <p class="setting-description">URL to fetch custom detection rules from</p>
                        </div>
                        
                        <div class="setting-item">
                            <label class="setting-label">
                                Update Interval (hours)
                                <input type="number" id="updateInterval" class="setting-input" min="1" max="168" value="24">
                            </label>
                            <p class="setting-description">How often to update detection rules</p>
                        </div>
                    </div>

                    <div class="setting-group">
                        <h3>Custom Rules Editor</h3>
                        <div class="setting-item">
                            <label class="setting-label">Custom Detection Rules (JSON)</label>
                            <textarea id="customRulesEditor" class="setting-textarea large" placeholder='{"malicious": [], "phishing": [], "suspicious": []}'></textarea>
                            <p class="setting-description">Define custom detection patterns in JSON format</p>
                            <div class="setting-actions">
                                <button class="btn btn-secondary small" id="validateRules">Validate</button>
                                <button class="btn btn-secondary small" id="loadDefaultRules">Load Defaults</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>



            <!-- Logs Section -->
            <section id="logs-section" class="settings-section">
                <div class="section-header">
                    <h2>Activity Logs</h2>
                    <p>View security events and extension activity</p>
                </div>

                <div class="logs-controls">
                    <div class="logs-filters">
                        <label class="setting-label">
                            <input type="checkbox" id="enableDebugLogging" class="setting-checkbox">
                            <span class="checkbox-custom"></span>
                            Enable Debug Logging
                        </label>
                        <select id="logFilter" class="setting-select">
                            <option value="all">All Events</option>
                            <option value="security">Security Events</option>
                            <option value="url_access">URL Access</option>
                            <option value="threat_detected">Threats Detected</option>
                            <option value="page_scanned">Page Scans</option>
                            <option value="debug">Debug Events</option>
                        </select>
                        <button class="btn btn-secondary" id="clearLogs">Clear Logs</button>
                        <button class="btn btn-secondary" id="exportLogs">Export Logs</button>
                    </div>
                </div>

                <div class="logs-container">
                    <div class="logs-header">
                        <div class="log-column-header timestamp">Timestamp</div>
                        <div class="log-column-header event-type">Event Type</div>
                        <div class="log-column-header url">URL/Domain</div>
                        <div class="log-column-header threat-level">Threat Level</div>
                        <div class="log-column-header action">Action Taken</div>
                        <div class="log-column-header details">Details</div>
                    </div>
                    <div class="logs-list" id="logsList">
                        <div class="log-entry">
                            <div class="log-column timestamp">Loading...</div>
                            <div class="log-column event-type">system</div>
                            <div class="log-column url">-</div>
                            <div class="log-column threat-level">-</div>
                            <div class="log-column action">-</div>
                            <div class="log-column details">Loading activity logs...</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Branding Section -->
            <section id="branding-section" class="settings-section">
                <div class="section-header">
                    <h2>Branding & White Labeling</h2>
                    <p>Customize the extension's appearance and branding</p>
                </div>

                <div class="settings-grid">
                    <div class="setting-group">
                        <h3>Company Information</h3>
                        <div class="setting-item">
                            <label class="setting-label">
                                Company Name
                                <input type="text" id="companyName" class="setting-input" placeholder="Your Company Name">
                            </label>
                            <p class="setting-description">Company name displayed in the extension</p>
                        </div>
                        
                        <div class="setting-item">
                            <label class="setting-label">
                                Product Name
                                <input type="text" id="productName" class="setting-input" placeholder="Custom Extension Name">
                            </label>
                            <p class="setting-description">Custom name for the extension</p>
                        </div>
                        
                        <div class="setting-item">
                            <label class="setting-label">
                                Support Email
                                <input type="email" id="supportEmail" class="setting-input" placeholder="support@yourcompany.com">
                            </label>
                            <p class="setting-description">Email address for user support</p>
                        </div>
                    </div>

                    <div class="setting-group">
                        <h3>Visual Customization</h3>
                        <div class="setting-item">
                            <label class="setting-label">
                                Primary Color
                                <input type="color" id="primaryColor" class="setting-color" value="#2563eb">
                            </label>
                            <p class="setting-description">Main theme color for the extension</p>
                        </div>
                        
                        <div class="setting-item">
                            <label class="setting-label">
                                Logo URL
                                <input type="url" id="logoUrl" class="setting-input" placeholder="https://yourcompany.com/logo.png">
                            </label>
                            <p class="setting-description">URL to your company logo</p>
                        </div>
                        
                        <div class="setting-item">
                            <label class="setting-label">Custom CSS</label>
                            <textarea id="customCss" class="setting-textarea" placeholder="/* Custom CSS styles */"></textarea>
                            <p class="setting-description">Additional CSS to customize the appearance</p>
                        </div>
                    </div>
                </div>

                <div class="branding-preview">
                    <h3>Preview</h3>
                    <div class="preview-popup" id="brandingPreview">
                        <div class="preview-header">
                            <img src="../images/icon32.png" alt="Check Logo" class="preview-logo" id="previewLogo">
                            <span class="preview-title" id="previewTitle">Microsoft 365 Phishing Protection</span>
                        </div>
                        <div class="preview-content">
                            <p>This is how your branding will appear in the extension popup.</p>
                            <button class="preview-button" id="previewButton">Sample Button</button>
                        </div>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Confirmation Modal -->
    <div class="modal-overlay" id="modalOverlay" style="display: none;">
        <div class="modal">
            <h3 class="modal-title" id="modalTitle">Confirm Action</h3>
            <p class="modal-message" id="modalMessage">Are you sure you want to proceed?</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="modalCancel">Cancel</button>
                <button class="btn btn-primary" id="modalConfirm">Confirm</button>
            </div>
        </div>
    </div>

    <script src="options.js"></script>
</body>
</html>
